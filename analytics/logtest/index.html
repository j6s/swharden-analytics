<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Log API Tester</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <script>
        function logNow() {

            data = {
                url: document.getElementById("input-url").value,
                ref: document.getElementById("input-ref").value,
            };

            url = '../';

            fetch(url,
                {
                    method: 'POST',
                    mode: 'cors',
                    body: JSON.stringify(data),
                })
                .then(response => {
                    if (response.status == 200) {
                        response.json().then(json => {
                            console.log(json);
                            document.getElementById("output-response").innerText = JSON.stringify(json, null, 2);
                        });
                    } else {
                        response.text().then(text => {
                            console.log(text);
                            document.getElementById("output-response").innerText = text;
                        });
                    }
                });
        }
    </script>

</head>

<body class="p-5">

    <div class="fs-4 fw-bold">Log API Tester</div>
    <div>This page will hit the logging API with arbitrary data</div>
    <div>View <a href='../live'>../live/</a> in another window to see the log result in real time.</div>

    <div class="border rounded bg-light p-3 my-3">
        <div class="mb-3">
            <label for="input-url" class="form-label">URL</label>
            <input type="text" class="form-control" id="input-url" value="http://example.com/url.html">
        </div>
        <div class="mb-3">
            <label for="input-ref" class="form-label">Referrer</label>
            <input type="text" class="form-control" id="input-ref" value="http://example.com/referrer.html">
        </div>
        <div class="mb-3">
            <label for="input-agent" class="form-label">Agent</label>
            <input type="text" class="form-control" id="input-agent" disabled>
            <div id="emailHelp" class="form-text">The logged value is the agent defined in the HTTP header of the POST
                request</div>
        </div>

        <button class="btn btn-primary mt-2" onclick="logNow();">Submit</button>
    </div>

    <div class="mb-3 mt-5">
        <div class="font-monospace" style="white-space: pre;" id="output-response">
        </div>
    </div>

    <script>
        document.getElementById("input-agent").value = window.navigator.userAgent;
    </script>

</body>

</html>